name: Comment Trigger

on:
  issue_comment:
    types: [created]

jobs:
  test:
    if: contains(github.event.comment.body, '/test')
    runs-on: ubuntu-latest
    steps:
    - name: First type
      run: echo "First type ${{ github.event.issue_comment.head.sha }}"
    - name: Second type
      run: echo "Second type ${{ github.event.workflow_run.head_sha }}"
      
  test2:
    runs-on: [ubuntu-latest]
    outputs:
      commit_sha: ${{ steps.variables.outputs.commit_sha }}
    steps:
    - uses: actions/github-script@v6
      id: set-sha-result
      with:
        github-token: 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
        script: |
          const pull_request = await github.rest.pulls.get({pull_number: context.issue.number, owner: context.repo.owner, repo: context.repo.repo})
          return pull_request.data.head.sha
        result-encoding: string

    - name: Set variable
      id: variables
      run: echo "commit_sha=${{steps.set-sha-result.outputs.result}}" >> $env:GITHUB_OUTPUT

    - name: Confirm variables
      run: echo "${{ steps.variables.outputs.commit_sha }}"
        
